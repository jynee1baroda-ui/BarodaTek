<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Demo Test - BarodaTek</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 30px;
            color: white;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        .result-box {
            background: rgba(255,255,255,0.15);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #4CAF50;
        }
        .error-box {
            border-left-color: #f44336;
        }
        .demo-section {
            background: rgba(0,0,0,0.2);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
        }
        .btn-test {
            margin: 10px 5px;
            padding: 12px 30px;
            font-weight: 600;
            cursor: pointer !important;
        }
        button, .btn {
            cursor: pointer !important;
        }
        button:hover, .btn:hover {
            cursor: pointer !important;
        }
        .contract-card {
            background: white;
            color: #333;
            padding: 20px;
            border-radius: 10px;
            margin: 10px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin: 5px;
        }
        .status-success { background: #4CAF50; color: white; }
        .status-error { background: #f44336; color: white; }
        .status-pending { background: #ff9800; color: white; }
        .api-response {
            background: #1e1e1e;
            color: #a9dc76;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="text-center mb-5">
            <h1><i class="fas fa-rocket me-3"></i>üöÄ Live Demo Test Suite</h1>
            <p class="lead">Testing REAL functionality - Not mock data!</p>
        </div>

        <!-- Test 1: Real Contract Creation -->
        <div class="demo-section">
            <h3><i class="fas fa-file-contract me-2"></i>1. Real Contract Creation</h3>
            <p>Create a real contract that gets stored in localStorage</p>
            
            <div class="row">
                <div class="col-md-6">
                    <input type="text" id="contractTitle" class="form-control mb-3" placeholder="Contract Title" value="Test Service Agreement">
                    <input type="text" id="contractParty" class="form-control mb-3" placeholder="Party Name" value="ABC Corp">
                    <input type="number" id="contractAmount" class="form-control mb-3" placeholder="Amount ($)" value="5000">
                    <button class="btn btn-success btn-test" onclick="createRealContract()">
                        <i class="fas fa-plus me-2"></i>Create Real Contract
                    </button>
                    <button class="btn btn-info btn-test" onclick="loadRealContracts()">
                        <i class="fas fa-sync me-2"></i>Load Saved Contracts
                    </button>
                    <button class="btn btn-danger btn-test" onclick="clearRealContracts()">
                        <i class="fas fa-trash me-2"></i>Clear All
                    </button>
                </div>
                <div class="col-md-6">
                    <div id="contract-results"></div>
                </div>
            </div>
        </div>

        <!-- Test 2: Real API Testing -->
        <div class="demo-section">
            <h3><i class="fas fa-server me-2"></i>2. Real API Testing</h3>
            <p>Make real HTTP requests to your API server</p>
            
            <button class="btn btn-primary btn-test" onclick="testRealAPI('GET')">
                <i class="fas fa-download me-2"></i>Test GET Request
            </button>
            <button class="btn btn-success btn-test" onclick="testRealAPI('POST')">
                <i class="fas fa-upload me-2"></i>Test POST Request
            </button>
            <button class="btn btn-warning btn-test" onclick="testRealAPI('PUT')">
                <i class="fas fa-edit me-2"></i>Test PUT Request
            </button>
            <button class="btn btn-danger btn-test" onclick="testRealAPI('DELETE')">
                <i class="fas fa-times me-2"></i>Test DELETE Request
            </button>
            
            <div id="api-results"></div>
        </div>

        <!-- Test 3: Real Data Export -->
        <div class="demo-section">
            <h3><i class="fas fa-file-export me-2"></i>3. Real Data Export</h3>
            <p>Export real contract data to downloadable files</p>
            
            <button class="btn btn-info btn-test" onclick="exportToJSON()">
                <i class="fas fa-file-code me-2"></i>Export to JSON
            </button>
            <button class="btn btn-primary btn-test" onclick="exportToCSV()">
                <i class="fas fa-file-csv me-2"></i>Export to CSV
            </button>
            <button class="btn btn-success btn-test" onclick="exportToMarkdown()">
                <i class="fas fa-file-alt me-2"></i>Export to Markdown
            </button>
            
            <div id="export-results"></div>
        </div>

        <!-- Test 4: Real Statistics -->
        <div class="demo-section">
            <h3><i class="fas fa-chart-bar me-2"></i>4. Real Statistics Dashboard</h3>
            <p>Display real statistics from stored contracts</p>
            
            <button class="btn btn-primary btn-test" onclick="generateRealStats()">
                <i class="fas fa-calculator me-2"></i>Generate Statistics
            </button>
            
            <div id="stats-results"></div>
        </div>

        <!-- Test 5: Real Validation -->
        <div class="demo-section">
            <h3><i class="fas fa-check-circle me-2"></i>5. Real Form Validation</h3>
            <p>Test form validation with real rules</p>
            
            <div class="row">
                <div class="col-md-6">
                    <input type="email" id="testEmail" class="form-control mb-3" placeholder="Enter email">
                    <input type="tel" id="testPhone" class="form-control mb-3" placeholder="Enter phone">
                    <input type="url" id="testURL" class="form-control mb-3" placeholder="Enter URL">
                    <button class="btn btn-warning btn-test" onclick="validateRealInput()">
                        <i class="fas fa-check me-2"></i>Validate Input
                    </button>
                </div>
                <div class="col-md-6">
                    <div id="validation-results"></div>
                </div>
            </div>
        </div>

        <!-- Overall Status -->
        <div class="demo-section text-center">
            <h3><i class="fas fa-clipboard-check me-2"></i>Overall Status</h3>
            <div id="overall-status">
                <p>Click buttons above to test features...</p>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Diagnostic: Check if script is loading
        console.log('‚úÖ test-live-demo.html JavaScript loaded!');
        
        // Real Contract Storage System
        const STORAGE_KEY = 'barodatek_real_contracts';
        let testResults = {
            contractCreation: false,
            apiTesting: false,
            dataExport: false,
            statistics: false,
            validation: false
        };

        function addResult(containerId, message, isError = false) {
            const container = document.getElementById(containerId);
            const div = document.createElement('div');
            div.className = `result-box ${isError ? 'error-box' : ''}`;
            div.innerHTML = message;
            container.appendChild(div);
        }

        // 1. Real Contract Creation
        function createRealContract() {
            const title = document.getElementById('contractTitle').value;
            const party = document.getElementById('contractParty').value;
            const amount = document.getElementById('contractAmount').value;

            if (!title || !party || !amount) {
                addResult('contract-results', '‚ùå Please fill all fields!', true);
                return;
            }

            // Create real contract object
            const contract = {
                id: Date.now(),
                title: title,
                party: party,
                amount: parseFloat(amount),
                status: 'active',
                createdAt: new Date().toISOString(),
                type: 'service_agreement'
            };

            // Store in localStorage
            const contracts = getStoredContracts();
            contracts.push(contract);
            localStorage.setItem(STORAGE_KEY, JSON.stringify(contracts));

            testResults.contractCreation = true;
            updateOverallStatus();

            addResult('contract-results', `
                ‚úÖ <strong>Contract Created Successfully!</strong><br>
                <div class="contract-card mt-3">
                    <h5>${contract.title}</h5>
                    <p><strong>Party:</strong> ${contract.party}</p>
                    <p><strong>Amount:</strong> $${contract.amount.toLocaleString()}</p>
                    <p><strong>ID:</strong> ${contract.id}</p>
                    <span class="status-badge status-success">${contract.status}</span>
                </div>
            `);
        }

        function getStoredContracts() {
            const stored = localStorage.getItem(STORAGE_KEY);
            return stored ? JSON.parse(stored) : [];
        }

        function loadRealContracts() {
            const contracts = getStoredContracts();
            const container = document.getElementById('contract-results');
            container.innerHTML = '';

            if (contracts.length === 0) {
                addResult('contract-results', '‚ÑπÔ∏è No contracts found. Create one above!', false);
                return;
            }

            let html = `<h5>üìã Found ${contracts.length} Real Contract(s):</h5>`;
            contracts.forEach(contract => {
                html += `
                    <div class="contract-card">
                        <h6>${contract.title}</h6>
                        <small><strong>Party:</strong> ${contract.party} | <strong>$${contract.amount.toLocaleString()}</strong></small>
                        <span class="status-badge status-success">${contract.status}</span>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function clearRealContracts() {
            if (confirm('Are you sure you want to delete all contracts?')) {
                localStorage.removeItem(STORAGE_KEY);
                addResult('contract-results', '‚úÖ All contracts deleted!');
            }
        }

        // 2. Real API Testing
        async function testRealAPI(method) {
            const container = document.getElementById('api-results');
            container.innerHTML = '<p>‚è≥ Testing API...</p>';

            try {
                const startTime = Date.now();
                let response;
                const baseURL = 'http://localhost:8080/api';

                switch(method) {
                    case 'GET':
                        response = await fetch(`${baseURL}/contracts`);
                        break;
                    case 'POST':
                        response = await fetch(`${baseURL}/contracts`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                title: 'Test Contract',
                                party: 'Test Party',
                                amount: 1000
                            })
                        });
                        break;
                    case 'PUT':
                        response = await fetch(`${baseURL}/contracts/1`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ status: 'updated' })
                        });
                        break;
                    case 'DELETE':
                        response = await fetch(`${baseURL}/contracts/1`, {
                            method: 'DELETE'
                        });
                        break;
                }

                const endTime = Date.now();
                const responseTime = endTime - startTime;
                const data = await response.json();

                testResults.apiTesting = true;
                updateOverallStatus();

                container.innerHTML = `
                    <div class="result-box">
                        ‚úÖ <strong>${method} Request Successful!</strong>
                        <span class="status-badge status-success">${response.status} ${response.statusText}</span>
                        <span class="status-badge status-pending">${responseTime}ms</span>
                        <div class="api-response">
                            ${JSON.stringify(data, null, 2)}
                        </div>
                    </div>
                `;
            } catch (error) {
                container.innerHTML = `
                    <div class="result-box error-box">
                        ‚ùå <strong>${method} Request Failed!</strong><br>
                        Error: ${error.message}
                    </div>
                `;
            }
        }

        // 3. Real Data Export
        function exportToJSON() {
            const contracts = getStoredContracts();
            const dataStr = JSON.stringify(contracts, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `barodatek-contracts-${Date.now()}.json`;
            a.click();

            testResults.dataExport = true;
            updateOverallStatus();

            addResult('export-results', `‚úÖ Exported ${contracts.length} contracts to JSON file!`);
        }

        function exportToCSV() {
            const contracts = getStoredContracts();
            let csv = 'ID,Title,Party,Amount,Status,Created At\n';
            contracts.forEach(c => {
                csv += `${c.id},"${c.title}","${c.party}",${c.amount},${c.status},${c.createdAt}\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `barodatek-contracts-${Date.now()}.csv`;
            a.click();

            addResult('export-results', `‚úÖ Exported ${contracts.length} contracts to CSV file!`);
        }

        function exportToMarkdown() {
            const contracts = getStoredContracts();
            let md = `# BarodaTek Contracts Export\n\n`;
            md += `**Export Date:** ${new Date().toLocaleDateString()}\n\n`;
            md += `**Total Contracts:** ${contracts.length}\n\n`;
            md += `---\n\n`;

            contracts.forEach((c, index) => {
                md += `## ${index + 1}. ${c.title}\n\n`;
                md += `- **Party:** ${c.party}\n`;
                md += `- **Amount:** $${c.amount.toLocaleString()}\n`;
                md += `- **Status:** ${c.status}\n`;
                md += `- **Created:** ${new Date(c.createdAt).toLocaleString()}\n`;
                md += `- **ID:** ${c.id}\n\n`;
                md += `---\n\n`;
            });

            const blob = new Blob([md], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `barodatek-contracts-${Date.now()}.md`;
            a.click();

            addResult('export-results', `‚úÖ Exported ${contracts.length} contracts to Markdown file!`);
        }

        // 4. Real Statistics
        function generateRealStats() {
            const contracts = getStoredContracts();
            
            if (contracts.length === 0) {
                addResult('stats-results', '‚ÑπÔ∏è No contracts to analyze. Create some first!', false);
                return;
            }

            const totalAmount = contracts.reduce((sum, c) => sum + c.amount, 0);
            const avgAmount = totalAmount / contracts.length;
            const activeContracts = contracts.filter(c => c.status === 'active').length;

            testResults.statistics = true;
            updateOverallStatus();

            document.getElementById('stats-results').innerHTML = `
                <div class="result-box">
                    <h5>üìä Real Statistics from ${contracts.length} Contracts:</h5>
                    <div class="row text-center mt-4">
                        <div class="col-md-3">
                            <h3 style="color: #4CAF50;">${contracts.length}</h3>
                            <p>Total Contracts</p>
                        </div>
                        <div class="col-md-3">
                            <h3 style="color: #2196F3;">$${totalAmount.toLocaleString()}</h3>
                            <p>Total Value</p>
                        </div>
                        <div class="col-md-3">
                            <h3 style="color: #ff9800;">$${Math.round(avgAmount).toLocaleString()}</h3>
                            <p>Average Value</p>
                        </div>
                        <div class="col-md-3">
                            <h3 style="color: #9C27B0;">${activeContracts}</h3>
                            <p>Active Contracts</p>
                        </div>
                    </div>
                </div>
            `;
        }

        // 5. Real Validation
        function validateRealInput() {
            const email = document.getElementById('testEmail').value;
            const phone = document.getElementById('testPhone').value;
            const url = document.getElementById('testURL').value;

            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            const phoneRegex = /^[\d\s\-\(\)]+$/;
            const urlRegex = /^https?:\/\/.+/;

            let results = '<h5>Validation Results:</h5>';
            let allValid = true;

            if (email) {
                const isValid = emailRegex.test(email);
                results += `<p>${isValid ? '‚úÖ' : '‚ùå'} Email: ${email} ${isValid ? '(Valid)' : '(Invalid)'}</p>`;
                allValid = allValid && isValid;
            }

            if (phone) {
                const isValid = phoneRegex.test(phone) && phone.replace(/\D/g, '').length >= 10;
                results += `<p>${isValid ? '‚úÖ' : '‚ùå'} Phone: ${phone} ${isValid ? '(Valid)' : '(Invalid)'}</p>`;
                allValid = allValid && isValid;
            }

            if (url) {
                const isValid = urlRegex.test(url);
                results += `<p>${isValid ? '‚úÖ' : '‚ùå'} URL: ${url} ${isValid ? '(Valid)' : '(Invalid)'}</p>`;
                allValid = allValid && isValid;
            }

            testResults.validation = true;
            updateOverallStatus();

            document.getElementById('validation-results').innerHTML = `
                <div class="result-box ${allValid ? '' : 'error-box'}">
                    ${results}
                </div>
            `;
        }

        // Overall Status Update
        function updateOverallStatus() {
            const total = Object.keys(testResults).length;
            const passed = Object.values(testResults).filter(v => v).length;
            const percentage = Math.round((passed / total) * 100);

            document.getElementById('overall-status').innerHTML = `
                <div class="result-box">
                    <h4>Test Progress: ${passed}/${total} (${percentage}%)</h4>
                    <div class="progress" style="height: 30px;">
                        <div class="progress-bar bg-success" style="width: ${percentage}%">
                            ${percentage}%
                        </div>
                    </div>
                    <div class="mt-3">
                        ${Object.entries(testResults).map(([key, value]) => `
                            <span class="status-badge ${value ? 'status-success' : 'status-pending'}">
                                ${value ? '‚úÖ' : '‚è≥'} ${key}
                            </span>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Initialize
        updateOverallStatus();
        
        // Visual confirmation that page is ready
        console.log('‚úÖ All functions defined and ready!');
        console.log('Functions available:', Object.keys(window).filter(k => 
            typeof window[k] === 'function' && 
            (k.includes('Real') || k.includes('Contract') || k.includes('export') || k.includes('test'))
        ));
        
        // Add ready indicator to page
        setTimeout(() => {
            document.querySelector('h1').innerHTML += ' <span style="color: #4CAF50;">‚óè</span>';
            document.querySelector('h1').title = 'All functions loaded and ready!';
        }, 500);
    </script>
</body>
</html>
