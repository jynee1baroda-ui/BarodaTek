<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Health Monitor - BarodaTek Pro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .monitor-container {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 30px;
            margin: 30px auto;
            max-width: 1400px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.3);
        }
        .status-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: transform 0.3s;
        }
        .status-card:hover {
            transform: translateY(-5px);
        }
        .status-up {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        .status-warning {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }
        .status-down {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .metric-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            background: rgba(255,255,255,0.3);
            margin: 5px;
        }
        .alert-config {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }
        .performance-bar {
            height: 30px;
            background: #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            margin: 10px 0;
        }
        .performance-fill {
            height: 100%;
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
            transition: width 1s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="monitor-container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h1><i class="fas fa-heartbeat me-3"></i>API Health Monitor</h1>
                <p class="text-muted">24/7 uptime monitoring, instant alerts, performance analytics</p>
            </div>
            <a href="index.html" class="btn btn-outline-secondary">
                <i class="fas fa-arrow-left me-2"></i>Back to Home
            </a>
        </div>

        <!-- Real-time Status Dashboard -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="status-card status-up" onclick="showDetails('health')">
                    <h5><i class="fas fa-check-circle me-2"></i>Health Check</h5>
                    <h2 class="mb-0" id="healthStatus">UP</h2>
                    <small>Response: <span id="healthResponse">45ms</span></small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="status-card status-up" onclick="showDetails('contracts')">
                    <h5><i class="fas fa-file-contract me-2"></i>Contracts API</h5>
                    <h2 class="mb-0" id="contractsStatus">UP</h2>
                    <small>Response: <span id="contractsResponse">82ms</span></small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="status-card status-up" onclick="showDetails('analytics')">
                    <h5><i class="fas fa-chart-bar me-2"></i>Analytics API</h5>
                    <h2 class="mb-0" id="analyticsStatus">UP</h2>
                    <small>Response: <span id="analyticsResponse">68ms</span></small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="status-card" id="uptimeCard">
                    <h5><i class="fas fa-clock me-2"></i>Uptime</h5>
                    <h2 class="mb-0" id="uptime">99.8%</h2>
                    <small>Last 30 days</small>
                </div>
            </div>
        </div>

        <!-- Performance Metrics -->
        <div class="chart-container">
            <h4><i class="fas fa-tachometer-alt me-2"></i>Performance Metrics</h4>
            <div class="row">
                <div class="col-md-6">
                    <label>Average Response Time</label>
                    <div class="performance-bar">
                        <div class="performance-fill" id="avgResponse" style="width: 65%;">65ms</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <label>Request Success Rate</label>
                    <div class="performance-bar">
                        <div class="performance-fill" id="successRate" style="width: 98%;">98%</div>
                    </div>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-md-6">
                    <label>Total Requests (24h)</label>
                    <div class="performance-bar">
                        <div class="performance-fill" style="width: 85%; background: linear-gradient(90deg, #f093fb 0%, #f5576c 100%);">
                            <span id="totalRequests">12,458</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <label>Error Rate</label>
                    <div class="performance-bar">
                        <div class="performance-fill" id="errorRate" style="width: 2%; background: linear-gradient(90deg, #fa709a 0%, #fee140 100%);">2%</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Alert Configuration -->
        <div class="chart-container">
            <h4><i class="fas fa-bell me-2"></i>Alert Configuration</h4>
            <div class="row">
                <div class="col-md-6">
                    <div class="alert-config">
                        <h6><i class="fas fa-envelope me-2"></i>Email Alerts</h6>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="emailDowntime" checked>
                            <label class="form-check-label" for="emailDowntime">Downtime detected</label>
                        </div>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="emailSlow" checked>
                            <label class="form-check-label" for="emailSlow">Slow response (>1000ms)</label>
                        </div>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="emailError">
                            <label class="form-check-label" for="emailError">Error rate spike</label>
                        </div>
                        <input type="email" class="form-control mt-2" placeholder="your-email@example.com" value="barodatek.services@gmail.com">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="alert-config">
                        <h6><i class="fas fa-sms me-2"></i>SMS Alerts</h6>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="smsDowntime" checked>
                            <label class="form-check-label" for="smsDowntime">Critical downtime</label>
                        </div>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="smsSecurityAlert">
                            <label class="form-check-label" for="smsSecurityAlert">Security alerts</label>
                        </div>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="smsDaily">
                            <label class="form-check-label" for="smsDaily">Daily summary</label>
                        </div>
                        <input type="tel" class="form-control mt-2" placeholder="+1 (555) 123-4567">
                    </div>
                </div>
            </div>
        </div>

        <!-- Historical Data -->
        <div class="chart-container">
            <h4><i class="fas fa-history me-2"></i>Historical Data (Last 7 Days)</h4>
            <canvas id="uptimeChart" style="max-height: 300px;"></canvas>
            <div class="mt-3">
                <button class="btn btn-outline-primary me-2" onclick="exportReport('csv')">
                    <i class="fas fa-download me-2"></i>Export CSV
                </button>
                <button class="btn btn-outline-primary me-2" onclick="exportReport('pdf')">
                    <i class="fas fa-file-pdf me-2"></i>Export PDF
                </button>
                <button class="btn btn-outline-success" onclick="generateReport()">
                    <i class="fas fa-chart-line me-2"></i>Generate Report
                </button>
            </div>
        </div>

        <!-- Recent Incidents -->
        <div class="chart-container">
            <h4><i class="fas fa-exclamation-triangle me-2"></i>Recent Incidents</h4>
            <div id="incidentLog">
                <!-- Incidents will be populated here -->
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Simulate real-time monitoring
        function updateMetrics() {
            const health = Math.random() * 100 + 20;
            const contracts = Math.random() * 150 + 50;
            const analytics = Math.random() * 120 + 40;
            
            document.getElementById('healthResponse').textContent = Math.round(health) + 'ms';
            document.getElementById('contractsResponse').textContent = Math.round(contracts) + 'ms';
            document.getElementById('analyticsResponse').textContent = Math.round(analytics) + 'ms';
            
            // Update performance bars
            const avgResp = (health + contracts + analytics) / 3;
            document.getElementById('avgResponse').style.width = Math.min(avgResp / 2, 100) + '%';
            document.getElementById('avgResponse').textContent = Math.round(avgResp) + 'ms';
            
            // Simulate request counter
            const current = parseInt(document.getElementById('totalRequests').textContent.replace(',', ''));
            document.getElementById('totalRequests').textContent = (current + Math.floor(Math.random() * 10)).toLocaleString();
        }

        // Update every 3 seconds
        setInterval(updateMetrics, 3000);

        // Show details
        function showDetails(endpoint) {
            alert(`${endpoint.toUpperCase()} Endpoint Details:\n\n` +
                  `Status: Operational\n` +
                  `Last checked: ${new Date().toLocaleTimeString()}\n` +
                  `24h Requests: ${Math.floor(Math.random() * 10000 + 5000)}\n` +
                  `Success Rate: ${(95 + Math.random() * 5).toFixed(2)}%\n\n` +
                  `Click 'OK' to view detailed logs.`);
        }

        // Export report
        function exportReport(format) {
            const data = {
                uptime: document.getElementById('uptime').textContent,
                avgResponse: document.getElementById('avgResponse').textContent,
                totalRequests: document.getElementById('totalRequests').textContent,
                errorRate: document.getElementById('errorRate').textContent,
                timestamp: new Date().toISOString()
            };

            if (format === 'csv') {
                const csv = Object.entries(data).map(([key, value]) => `${key},${value}`).join('\n');
                downloadFile(csv, 'health-report.csv', 'text/csv');
            } else if (format === 'pdf') {
                alert('PDF Report Generated!\n\nYour comprehensive health report is being generated.\n\nThis would normally include:\n- Uptime statistics\n- Performance graphs\n- Incident timeline\n- Alert history\n\nReport will be emailed to: barodatek.services@gmail.com');
            }
        }

        function downloadFile(content, filename, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }

        function generateReport() {
            const reportHtml = `
                <h3>API Health Report - ${new Date().toLocaleDateString()}</h3>
                <p><strong>Overall Status:</strong> Healthy</p>
                <p><strong>Uptime:</strong> ${document.getElementById('uptime').textContent}</p>
                <p><strong>Average Response:</strong> ${document.getElementById('avgResponse').textContent}</p>
                <p><strong>Total Requests:</strong> ${document.getElementById('totalRequests').textContent}</p>
                <p><strong>Success Rate:</strong> ${document.getElementById('successRate').textContent}</p>
                <hr>
                <h4>Recommendations:</h4>
                <ul>
                    <li>✅ All endpoints performing optimally</li>
                    <li>✅ Response times within acceptable range</li>
                    <li>⚠️ Consider caching to reduce load</li>
                    <li>✅ Error rate below threshold</li>
                </ul>
            `;
            
            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(`
                <html>
                <head>
                    <title>Health Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: auto; }
                        h3 { color: #667eea; }
                    </style>
                </head>
                <body>${reportHtml}</body>
                </html>
            `);
        }

        // Populate incident log
        function populateIncidents() {
            const incidents = [
                { time: '2 hours ago', type: 'warning', message: 'Slow response time detected (>500ms) - Auto-scaled' },
                { time: '1 day ago', type: 'success', message: 'Health check passed - All systems nominal' },
                { time: '2 days ago', type: 'info', message: 'Scheduled maintenance completed successfully' },
                { time: '3 days ago', type: 'warning', message: 'High traffic detected - 15K requests/hour' }
            ];

            const logHtml = incidents.map(inc => `
                <div class="alert alert-${inc.type === 'warning' ? 'warning' : inc.type === 'success' ? 'success' : 'info'} mb-2">
                    <small class="text-muted">${inc.time}</small>
                    <p class="mb-0">${inc.message}</p>
                </div>
            `).join('');

            document.getElementById('incidentLog').innerHTML = logHtml;
        }

        // Create uptime chart
        function createChart() {
            const ctx = document.getElementById('uptimeChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Uptime %',
                        data: [99.9, 99.8, 100, 99.7, 99.9, 99.8, 99.9],
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Avg Response (ms)',
                        data: [65, 72, 58, 88, 65, 70, 62],
                        borderColor: '#f5576c',
                        backgroundColor: 'rgba(245, 87, 108, 0.1)',
                        tension: 0.4,
                        fill: true,
                        yAxisID: 'y1'
                    }]
                },
                options: {
                    responsive: true,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            min: 99,
                            max: 100.5
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            min: 0,
                            max: 150,
                            grid: {
                                drawOnChartArea: false,
                            },
                        }
                    }
                }
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            populateIncidents();
            createChart();
            updateMetrics();
        });
    </script>
</body>
</html>
